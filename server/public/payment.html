<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stripe Payment Test</title>
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
  <h2>Test Payment</h2>
  <button id="pay-button">Pay Now</button>

  <script>
    const payButton = document.getElementById('pay-button');

    payButton.addEventListener('click', async () => {
      const response = await fetch('http://localhost:5000/payment', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer your_test_token' // 如果需要 JWT token，填上
        },
        body: JSON.stringify({ orderID: 1 }) // 换成你要测试的 orderID
      });

      const data = await response.json();
      const clientSecret = data.data.clientSecret;
      console.log('Client secret:', clientSecret);

      const stripe = Stripe('your_publishable_key'); // 填你的 Stripe Publishable Key

      const result = await stripe.confirmCardPayment(clientSecret, {
        payment_method: {
          card: {
            number: '4242424242424242',
            exp_month: 12,
            exp_year: 2026,
            cvc: '123',
          },
        },
      });

      if (result.error) {
        alert('Payment failed: ' + result.error.message);
      } else {
        if (result.paymentIntent.status === 'succeeded') {
          alert('Payment succeeded!');
        }
      }
    });
  </script>
</body>
</html>
